{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":80},"end":{"line":2,"column":69,"index":149}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":151},"end":{"line":3,"column":26,"index":177}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"C:\\\\Users\\\\sagun\\\\OneDrive\\\\Documents\\\\GitHub\\\\WRENCH_CLOUD\\\\Hybrid-Human-ECO\\\\frontend\\\\contexts\\\\AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _axios = require(_dependencyMap[2], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const API_URL = process.env.EXPO_PUBLIC_BACKEND_URL + '/api';\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [token, setToken] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      loadStoredAuth();\n    }, []);\n    const loadStoredAuth = async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('token');\n        const storedUser = await AsyncStorage.default.getItem('user');\n        if (storedToken && storedUser) {\n          setToken(storedToken);\n          setUser(JSON.parse(storedUser));\n\n          // Verify token is still valid\n          try {\n            const response = await axios.default.get(`${API_URL}/auth/me`, {\n              headers: {\n                Authorization: `Bearer ${storedToken}`\n              }\n            });\n            setUser(response.data);\n          } catch (error) {\n            // Token invalid, clear storage\n            await AsyncStorage.default.removeItem('token');\n            await AsyncStorage.default.removeItem('user');\n            setToken(null);\n            setUser(null);\n          }\n        }\n      } catch (error) {\n        console.error('Error loading stored auth:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async (identifier, password) => {\n      try {\n        const response = await axios.default.post(`${API_URL}/auth/login`, {\n          identifier,\n          password\n        });\n        const {\n          access_token,\n          user: userData\n        } = response.data;\n        await AsyncStorage.default.setItem('token', access_token);\n        await AsyncStorage.default.setItem('user', JSON.stringify(userData));\n        setToken(access_token);\n        setUser(userData);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || 'Login failed');\n      }\n    };\n    const register = async userData => {\n      try {\n        const response = await axios.default.post(`${API_URL}/auth/register`, userData);\n        const {\n          access_token,\n          user: newUser\n        } = response.data;\n        await AsyncStorage.default.setItem('token', access_token);\n        await AsyncStorage.default.setItem('user', JSON.stringify(newUser));\n        setToken(access_token);\n        setUser(newUser);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || 'Registration failed');\n      }\n    };\n    const logout = async () => {\n      try {\n        await AsyncStorage.default.removeItem('token');\n        await AsyncStorage.default.removeItem('user');\n        setToken(null);\n        setUser(null);\n      } catch (error) {\n        console.error('Error during logout:', error);\n      }\n    };\n    const isAdmin = user?.role === 'admin';\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        token,\n        isLoading,\n        login,\n        register,\n        logout,\n        isAdmin\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 5\n    }, this);\n  };\n  const useAuth = () => {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n});","lineCount":140,"map":[[13,2,30,0,"Object"],[13,8,30,0],[13,9,30,0,"defineProperty"],[13,23,30,0],[13,24,30,0,"exports"],[13,31,30,0],[14,4,30,0,"enumerable"],[14,14,30,0],[15,4,30,0,"get"],[15,7,30,0],[15,18,30,0,"get"],[15,19,30,0],[16,6,30,0],[16,13,30,0,"AuthProvider"],[16,25,30,0],[17,4,30,0],[18,2,30,0],[19,2,134,0,"Object"],[19,8,134,0],[19,9,134,0,"defineProperty"],[19,23,134,0],[19,24,134,0,"exports"],[19,31,134,0],[20,4,134,0,"enumerable"],[20,14,134,0],[21,4,134,0,"get"],[21,7,134,0],[21,18,134,0,"get"],[21,19,134,0],[22,6,134,0],[22,13,134,0,"useAuth"],[22,20,134,0],[23,4,134,0],[24,2,134,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,2,0],[26,45,2,0,"require"],[26,52,2,0],[26,53,2,0,"_dependencyMap"],[26,67,2,0],[27,2,2,0],[27,6,2,0,"AsyncStorage"],[27,18,2,0],[27,21,2,0,"_interopDefault"],[27,36,2,0],[27,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,2,0],[28,2,3,0],[28,6,3,0,"_axios"],[28,12,3,0],[28,15,3,0,"require"],[28,22,3,0],[28,23,3,0,"_dependencyMap"],[28,37,3,0],[29,2,3,0],[29,6,3,0,"axios"],[29,11,3,0],[29,14,3,0,"_interopDefault"],[29,29,3,0],[29,30,3,0,"_axios"],[29,36,3,0],[30,2,3,26],[30,6,3,26,"_reactJsxDevRuntime"],[30,25,3,26],[30,28,3,26,"require"],[30,35,3,26],[30,36,3,26,"_dependencyMap"],[30,50,3,26],[31,2,5,0],[31,8,5,6,"API_URL"],[31,15,5,13],[31,18,5,16,"process"],[31,25,5,23],[31,26,5,24,"env"],[31,29,5,27],[31,30,5,28,"EXPO_PUBLIC_BACKEND_URL"],[31,53,5,51],[31,56,5,54],[31,62,5,60],[32,2,28,0],[32,8,28,6,"AuthContext"],[32,19,28,17],[32,35,28,20],[32,39,28,20,"createContext"],[32,45,28,33],[32,46,28,33,"createContext"],[32,59,28,33],[32,61,28,63,"undefined"],[32,70,28,72],[32,71,28,73],[33,2,30,7],[33,8,30,13,"AuthProvider"],[33,20,30,66],[33,23,30,69,"AuthProvider"],[33,24,30,70],[34,4,30,72,"children"],[35,2,30,81],[35,3,30,82],[35,8,30,87],[36,4,31,2],[36,10,31,8],[36,11,31,9,"user"],[36,15,31,13],[36,17,31,15,"setUser"],[36,24,31,22],[36,25,31,23],[36,28,31,26],[36,32,31,26,"useState"],[36,38,31,34],[36,39,31,34,"useState"],[36,47,31,34],[36,49,31,48],[36,53,31,52],[36,54,31,53],[37,4,32,2],[37,10,32,8],[37,11,32,9,"token"],[37,16,32,14],[37,18,32,16,"setToken"],[37,26,32,24],[37,27,32,25],[37,30,32,28],[37,34,32,28,"useState"],[37,40,32,36],[37,41,32,36,"useState"],[37,49,32,36],[37,51,32,52],[37,55,32,56],[37,56,32,57],[38,4,33,2],[38,10,33,8],[38,11,33,9,"isLoading"],[38,20,33,18],[38,22,33,20,"setIsLoading"],[38,34,33,32],[38,35,33,33],[38,38,33,36],[38,42,33,36,"useState"],[38,48,33,44],[38,49,33,44,"useState"],[38,57,33,44],[38,59,33,45],[38,63,33,49],[38,64,33,50],[39,4,35,2],[39,8,35,2,"useEffect"],[39,14,35,11],[39,15,35,11,"useEffect"],[39,24,35,11],[39,26,35,12],[39,32,35,18],[40,6,36,4,"loadStoredAuth"],[40,20,36,18],[40,21,36,19],[40,22,36,20],[41,4,37,2],[41,5,37,3],[41,7,37,5],[41,9,37,7],[41,10,37,8],[42,4,39,2],[42,10,39,8,"loadStoredAuth"],[42,24,39,22],[42,27,39,25],[42,33,39,25,"loadStoredAuth"],[42,34,39,25],[42,39,39,37],[43,6,40,4],[43,10,40,8],[44,8,41,6],[44,14,41,12,"storedToken"],[44,25,41,23],[44,28,41,26],[44,34,41,32,"AsyncStorage"],[44,46,41,44],[44,47,41,44,"default"],[44,54,41,44],[44,55,41,45,"getItem"],[44,62,41,52],[44,63,41,53],[44,70,41,60],[44,71,41,61],[45,8,42,6],[45,14,42,12,"storedUser"],[45,24,42,22],[45,27,42,25],[45,33,42,31,"AsyncStorage"],[45,45,42,43],[45,46,42,43,"default"],[45,53,42,43],[45,54,42,44,"getItem"],[45,61,42,51],[45,62,42,52],[45,68,42,58],[45,69,42,59],[46,8,44,6],[46,12,44,10,"storedToken"],[46,23,44,21],[46,27,44,25,"storedUser"],[46,37,44,35],[46,39,44,37],[47,10,45,8,"setToken"],[47,18,45,16],[47,19,45,17,"storedToken"],[47,30,45,28],[47,31,45,29],[48,10,46,8,"setUser"],[48,17,46,15],[48,18,46,16,"JSON"],[48,22,46,20],[48,23,46,21,"parse"],[48,28,46,26],[48,29,46,27,"storedUser"],[48,39,46,37],[48,40,46,38],[48,41,46,39],[50,10,48,8],[51,10,49,8],[51,14,49,12],[52,12,50,10],[52,18,50,16,"response"],[52,26,50,24],[52,29,50,27],[52,35,50,33,"axios"],[52,40,50,38],[52,41,50,38,"default"],[52,48,50,38],[52,49,50,39,"get"],[52,52,50,42],[52,53,50,43],[52,56,50,46,"API_URL"],[52,63,50,53],[52,73,50,63],[52,75,50,65],[53,14,51,12,"headers"],[53,21,51,19],[53,23,51,21],[54,16,51,23,"Authorization"],[54,29,51,36],[54,31,51,38],[54,41,51,48,"storedToken"],[54,52,51,59],[55,14,51,62],[56,12,52,10],[56,13,52,11],[56,14,52,12],[57,12,53,10,"setUser"],[57,19,53,17],[57,20,53,18,"response"],[57,28,53,26],[57,29,53,27,"data"],[57,33,53,31],[57,34,53,32],[58,10,54,8],[58,11,54,9],[58,12,54,10],[58,19,54,17,"error"],[58,24,54,22],[58,26,54,24],[59,12,55,10],[60,12,56,10],[60,18,56,16,"AsyncStorage"],[60,30,56,28],[60,31,56,28,"default"],[60,38,56,28],[60,39,56,29,"removeItem"],[60,49,56,39],[60,50,56,40],[60,57,56,47],[60,58,56,48],[61,12,57,10],[61,18,57,16,"AsyncStorage"],[61,30,57,28],[61,31,57,28,"default"],[61,38,57,28],[61,39,57,29,"removeItem"],[61,49,57,39],[61,50,57,40],[61,56,57,46],[61,57,57,47],[62,12,58,10,"setToken"],[62,20,58,18],[62,21,58,19],[62,25,58,23],[62,26,58,24],[63,12,59,10,"setUser"],[63,19,59,17],[63,20,59,18],[63,24,59,22],[63,25,59,23],[64,10,60,8],[65,8,61,6],[66,6,62,4],[66,7,62,5],[66,8,62,6],[66,15,62,13,"error"],[66,20,62,18],[66,22,62,20],[67,8,63,6,"console"],[67,15,63,13],[67,16,63,14,"error"],[67,21,63,19],[67,22,63,20],[67,50,63,48],[67,52,63,50,"error"],[67,57,63,55],[67,58,63,56],[68,6,64,4],[68,7,64,5],[68,16,64,14],[69,8,65,6,"setIsLoading"],[69,20,65,18],[69,21,65,19],[69,26,65,24],[69,27,65,25],[70,6,66,4],[71,4,67,2],[71,5,67,3],[72,4,69,2],[72,10,69,8,"login"],[72,15,69,13],[72,18,69,16],[72,24,69,16,"login"],[72,25,69,23,"identifier"],[72,35,69,41],[72,37,69,43,"password"],[72,45,69,59],[72,50,69,64],[73,6,70,4],[73,10,70,8],[74,8,71,6],[74,14,71,12,"response"],[74,22,71,20],[74,25,71,23],[74,31,71,29,"axios"],[74,36,71,34],[74,37,71,34,"default"],[74,44,71,34],[74,45,71,35,"post"],[74,49,71,39],[74,50,71,40],[74,53,71,43,"API_URL"],[74,60,71,50],[74,73,71,63],[74,75,71,65],[75,10,72,8,"identifier"],[75,20,72,18],[76,10,73,8,"password"],[77,8,74,6],[77,9,74,7],[77,10,74,8],[78,8,76,6],[78,14,76,12],[79,10,76,14,"access_token"],[79,22,76,26],[80,10,76,28,"user"],[80,14,76,32],[80,16,76,34,"userData"],[81,8,76,43],[81,9,76,44],[81,12,76,47,"response"],[81,20,76,55],[81,21,76,56,"data"],[81,25,76,60],[82,8,78,6],[82,14,78,12,"AsyncStorage"],[82,26,78,24],[82,27,78,24,"default"],[82,34,78,24],[82,35,78,25,"setItem"],[82,42,78,32],[82,43,78,33],[82,50,78,40],[82,52,78,42,"access_token"],[82,64,78,54],[82,65,78,55],[83,8,79,6],[83,14,79,12,"AsyncStorage"],[83,26,79,24],[83,27,79,24,"default"],[83,34,79,24],[83,35,79,25,"setItem"],[83,42,79,32],[83,43,79,33],[83,49,79,39],[83,51,79,41,"JSON"],[83,55,79,45],[83,56,79,46,"stringify"],[83,65,79,55],[83,66,79,56,"userData"],[83,74,79,64],[83,75,79,65],[83,76,79,66],[84,8,81,6,"setToken"],[84,16,81,14],[84,17,81,15,"access_token"],[84,29,81,27],[84,30,81,28],[85,8,82,6,"setUser"],[85,15,82,13],[85,16,82,14,"userData"],[85,24,82,22],[85,25,82,23],[86,6,83,4],[86,7,83,5],[86,8,83,6],[86,15,83,13,"error"],[86,20,83,23],[86,22,83,25],[87,8,84,6],[87,14,84,12],[87,18,84,16,"Error"],[87,23,84,21],[87,24,84,22,"error"],[87,29,84,27],[87,30,84,28,"response"],[87,38,84,36],[87,40,84,38,"data"],[87,44,84,42],[87,46,84,44,"detail"],[87,52,84,50],[87,56,84,54],[87,70,84,68],[87,71,84,69],[88,6,85,4],[89,4,86,2],[89,5,86,3],[90,4,88,2],[90,10,88,8,"register"],[90,18,88,16],[90,21,88,19],[90,27,88,26,"userData"],[90,35,88,39],[90,39,88,44],[91,6,89,4],[91,10,89,8],[92,8,90,6],[92,14,90,12,"response"],[92,22,90,20],[92,25,90,23],[92,31,90,29,"axios"],[92,36,90,34],[92,37,90,34,"default"],[92,44,90,34],[92,45,90,35,"post"],[92,49,90,39],[92,50,90,40],[92,53,90,43,"API_URL"],[92,60,90,50],[92,76,90,66],[92,78,90,68,"userData"],[92,86,90,76],[92,87,90,77],[93,8,92,6],[93,14,92,12],[94,10,92,14,"access_token"],[94,22,92,26],[95,10,92,28,"user"],[95,14,92,32],[95,16,92,34,"newUser"],[96,8,92,42],[96,9,92,43],[96,12,92,46,"response"],[96,20,92,54],[96,21,92,55,"data"],[96,25,92,59],[97,8,94,6],[97,14,94,12,"AsyncStorage"],[97,26,94,24],[97,27,94,24,"default"],[97,34,94,24],[97,35,94,25,"setItem"],[97,42,94,32],[97,43,94,33],[97,50,94,40],[97,52,94,42,"access_token"],[97,64,94,54],[97,65,94,55],[98,8,95,6],[98,14,95,12,"AsyncStorage"],[98,26,95,24],[98,27,95,24,"default"],[98,34,95,24],[98,35,95,25,"setItem"],[98,42,95,32],[98,43,95,33],[98,49,95,39],[98,51,95,41,"JSON"],[98,55,95,45],[98,56,95,46,"stringify"],[98,65,95,55],[98,66,95,56,"newUser"],[98,73,95,63],[98,74,95,64],[98,75,95,65],[99,8,97,6,"setToken"],[99,16,97,14],[99,17,97,15,"access_token"],[99,29,97,27],[99,30,97,28],[100,8,98,6,"setUser"],[100,15,98,13],[100,16,98,14,"newUser"],[100,23,98,21],[100,24,98,22],[101,6,99,4],[101,7,99,5],[101,8,99,6],[101,15,99,13,"error"],[101,20,99,23],[101,22,99,25],[102,8,100,6],[102,14,100,12],[102,18,100,16,"Error"],[102,23,100,21],[102,24,100,22,"error"],[102,29,100,27],[102,30,100,28,"response"],[102,38,100,36],[102,40,100,38,"data"],[102,44,100,42],[102,46,100,44,"detail"],[102,52,100,50],[102,56,100,54],[102,77,100,75],[102,78,100,76],[103,6,101,4],[104,4,102,2],[104,5,102,3],[105,4,104,2],[105,10,104,8,"logout"],[105,16,104,14],[105,19,104,17],[105,25,104,17,"logout"],[105,26,104,17],[105,31,104,29],[106,6,105,4],[106,10,105,8],[107,8,106,6],[107,14,106,12,"AsyncStorage"],[107,26,106,24],[107,27,106,24,"default"],[107,34,106,24],[107,35,106,25,"removeItem"],[107,45,106,35],[107,46,106,36],[107,53,106,43],[107,54,106,44],[108,8,107,6],[108,14,107,12,"AsyncStorage"],[108,26,107,24],[108,27,107,24,"default"],[108,34,107,24],[108,35,107,25,"removeItem"],[108,45,107,35],[108,46,107,36],[108,52,107,42],[108,53,107,43],[109,8,108,6,"setToken"],[109,16,108,14],[109,17,108,15],[109,21,108,19],[109,22,108,20],[110,8,109,6,"setUser"],[110,15,109,13],[110,16,109,14],[110,20,109,18],[110,21,109,19],[111,6,110,4],[111,7,110,5],[111,8,110,6],[111,15,110,13,"error"],[111,20,110,18],[111,22,110,20],[112,8,111,6,"console"],[112,15,111,13],[112,16,111,14,"error"],[112,21,111,19],[112,22,111,20],[112,44,111,42],[112,46,111,44,"error"],[112,51,111,49],[112,52,111,50],[113,6,112,4],[114,4,113,2],[114,5,113,3],[115,4,115,2],[115,10,115,8,"isAdmin"],[115,17,115,15],[115,20,115,18,"user"],[115,24,115,22],[115,26,115,24,"role"],[115,30,115,28],[115,35,115,33],[115,42,115,40],[116,4,117,2],[116,24,118,4],[116,28,118,4,"_reactJsxDevRuntime"],[116,47,118,4],[116,48,118,4,"jsxDEV"],[116,54,118,4],[116,56,118,5,"AuthContext"],[116,67,118,16],[116,68,118,17,"Provider"],[116,76,118,25],[117,6,119,6,"value"],[117,11,119,11],[117,13,119,13],[118,8,120,8,"user"],[118,12,120,12],[119,8,121,8,"token"],[119,13,121,13],[120,8,122,8,"isLoading"],[120,17,122,17],[121,8,123,8,"login"],[121,13,123,13],[122,8,124,8,"register"],[122,16,124,16],[123,8,125,8,"logout"],[123,14,125,14],[124,8,126,8,"isAdmin"],[125,6,127,6],[125,7,127,8],[126,6,127,8,"children"],[126,14,127,8],[126,16,129,7,"children"],[127,4,129,15],[128,6,129,15,"fileName"],[128,14,129,15],[128,16,129,15,"_jsxFileName"],[128,28,129,15],[129,6,129,15,"lineNumber"],[129,16,129,15],[130,6,129,15,"columnNumber"],[130,18,129,15],[131,4,129,15],[131,11,130,26],[131,12,130,27],[132,2,132,0],[132,3,132,1],[133,2,134,7],[133,8,134,13,"useAuth"],[133,15,134,20],[133,18,134,23,"useAuth"],[133,19,134,23],[133,24,134,29],[134,4,135,2],[134,10,135,8,"context"],[134,17,135,15],[134,20,135,18],[134,24,135,18,"useContext"],[134,30,135,28],[134,31,135,28,"useContext"],[134,41,135,28],[134,43,135,29,"AuthContext"],[134,54,135,40],[134,55,135,41],[135,4,136,2],[135,8,136,6,"context"],[135,15,136,13],[135,20,136,18,"undefined"],[135,29,136,27],[135,31,136,29],[136,6,137,4],[136,12,137,10],[136,16,137,14,"Error"],[136,21,137,19],[136,22,137,20],[136,67,137,65],[136,68,137,66],[137,4,138,2],[138,4,139,2],[138,11,139,9,"context"],[138,18,139,16],[139,2,140,0],[139,3,140,1],[140,0,140,2],[140,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","loadStoredAuth","login","register","logout","useAuth"],"mappings":"AAA;qEC6B;YCK;GDE;yBEE;GF4B;gBGE;GHiB;mBIE;GJc;iBKE;GLS;CDmB;uBOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}